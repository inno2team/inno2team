<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200;300;400;500;600;700;900&display=swap"
        rel="stylesheet" />

    <title>test</title>

    <style>
        * {
            font-family: "Noto Serif KR", serif;
        }

        .room-top {
            margin-top: 100px;
            margin-bottom: 100px;
        }
    </style>


    <script>
        $(document).ready(function () {
            listing();
        });




        function listing() {
            fetch('/board/get/{{id}}').then((res) => res.json()).then((data) => {
                if (data["msg"] === undefined) {
                    let room = JSON.parse(data['result'])

                    console.log(room)
                    // $('room').empty()

                    let name = room['room_name']
                    let location = room['location']
                    let owner = room['user_id']
                    let prt_users = room['prt_users']
                    let phone_number = phone_search(owner)
                    console.log(phone_number)

                    let temp_html = `<div class="fs-1 text-center room-top">
                                    <p>방이름: ${name} </p>
                                    <p>모임 장소: ${location}</p>
                                </div>
                                    
                                <div class="fs-2 text-center room-bottom" id="phone_numbers">
                                    <p> 방장 : ${owner} </p>
                                </div>`

                    $('#room').append(temp_html)

                    prt_users.forEach((u) => {
                        if (u != owner) {
                            phone_search(u)
                        }
                    })
                } else {
                    alert(data["msg"]);
                    location.href='/'
                }
            })
        }

        function phone_search(user_id) {
            fetch(`/user/get/${user_id}`).then((res) => res.json()).then((data) => {
                let temp_html = `<p> ${user_id} : ${data['result']['phone']} </p>`
                $('#phone_numbers').append(temp_html)
            })
        }


    </script>

</head>

<body>
    <div id="room">
        <!-- <div>
            <p>방이름: </p>
            <p>모임 장소: </p>
        </div>

        <div>
            <p>방장 연락처: </p>
            <p>사람1 연락처: </p>
            <p>사람2 연락처: </p>
            <p>사람3 연락처: </p>
        </div> -->
    </div>





</body>

</html>